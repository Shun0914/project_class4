# Sprint 2（Week2）タスク分割案

## Sprint 2の目標

**2/11 〜 2/17 で追加機能を実装し、より完成度の高いプロトタイプを完成させる**

- Sprint 1で実装した認証・支出記録・分析機能をベースに拡張
- 11期チームの機能統合（MOF、wasabimonja、くんよみの知見を活用）
- ダッシュボード画面の実装
- ユーザビリティの向上

**完了の定義**:
- 履歴表示・予算設定が動作する
- レシート画像の自動認識・入力が動作する（最高優先度）
- ダッシュボード画面が実装されている
- 主要な11期機能統合が完了している
- Sprint 1の機能が安定して動作している

**参照**: [基本要件定義書](../requirements/基本要件定義書.md) の「Sprint 2」「2.2. 追加実装機能」、[機能一覧](../requirements/機能一覧.md)

---

## 📋 Sprint 2のスコープ（合意が必要）

### 🔴 最優先（必須）

1. **履歴表示機能**
   - 支出履歴の一覧表示
   - 日付順ソート
   - ページネーション

2. **予算設定機能**
   - 月次予算の設定・更新
   - 予算と実績の比較表示
   - 予算超過時のアラート
   - **予算未設定時でもダッシュボードから設定可能**（議事録より）

3. **レシート画像の自動認識・入力**（11期機能統合・最高優先度）
   - GPT-4 Vision APIによる画像解析
   - **撮影から複数品目の同時検出を想定**（議事録より）
   - アイテム名・金額・日付の自動抽出
   - **検出結果を追加して一括保存可能**（議事録より）
   - 抽出結果の確認・編集機能
   - **誤操作時はモーダルを閉じて戻れる**（議事録より）

4. **ダッシュボード画面の実装**（Sprint 1では必須から外した機能）
   - 月次予算の集計表示
   - **カテゴリ色分け（食費、日用品、趣味娯楽、交通費、水道光熱費、二分類）を採用**（議事録より）
   - **目標達成/未設定/予算オーバー等のステータス表示**（議事録より）
   - **分析機能の入口（データなしならエンプティ表示、再分析も可能）**（議事録より）
   - 予算未設定時でもダッシュボードから設定可能
   - **カテゴリ別の内訳詳細（矢印押下で展開）**（議事録より）
   - **絞り込み機能（検索、カテゴリ別、日付別）。モーダル上にモーダルを重ねるUI想定**（議事録より）

5. **ホーム画面の拡張**（議事録より）
   - **ホームに内訳を置く案の実装**（コーチ重視の体験とのバランスで一旦試験的に入れる）

### 🟠 高優先度（できれば実装）

6. **サービス名正規化機能**（11期機能統合・最高優先度・エッセンスのみ）
   - 500以上のサービス名マッピング
   - 表記揺れ対応
   - **既存コード（wasabimonja）のエッセンスを参考に実装**（完全コピーではなく、エッセンスのみ）

7. **評価機能**（11期機能統合・高優先度・エッセンスのみ）
   - 支出アイテムごとの評価（役立った/役立たなかった）
   - 評価スコアの集計・表示
   - **既存コード（くんよみ）のエッセンスを参考に実装**（完全コピーではなく、エッセンスのみ）

8. **カテゴリ分類機能**（11期機能統合・中優先度）
   - **支出記録時のカテゴリ選択のみ**（カテゴリマスターの管理機能は除外）
   - カテゴリ別の支出集計
   - **既存コード（くんよみ）のエッセンスを参考に実装**（完全コピーではなく、エッセンスのみ）

### 🟡 中優先度（時間があれば）

9. **明細書解析機能の拡張**（11期機能統合・高優先度・エッセンスのみ）
   - PDF・画像・CSVの統合解析
   - 定期性パターン検出
   - **既存コード（wasabimonja）のエッセンスを参考に実装**（完全コピーではなく、エッセンスのみ）

10. **キーワード検索機能**（11期機能統合・中優先度・エッセンスのみ）
   - キーワードによる支出履歴の検索
   - 表記揺れ対応
   - **既存コード（くんよみ）のエッセンスを参考に実装**（完全コピーではなく、エッセンスのみ）

11. **検出履歴管理**（11期機能統合・中優先度・エッセンスのみ）
    - 明細書解析結果の履歴保存・参照
    - **既存コード（wasabimonja）のエッセンスを参考に実装**（完全コピーではなく、エッセンスのみ）

12. **週次サマリー機能**（議事録で実装方針を採用と決定）
    - 週次レポートの自動生成
    - ホーム画面に直近レポートを表示
    - **メール配信機能はSprint 3に延期**（ベロシティを考慮）

### 🔵 低優先度（オプション）

13. **レポート機能**（オプション）
    - 月次集計の表示
    - グラフ表示
    - トレンド分析

---

## 依存関係

### 明確な依存関係

1. **履歴表示機能**
   - **依存**: Sprint 1の支出記録API（支出データが必要）

2. **予算設定機能**
   - **依存**: なし（独立して実装可能）
   - **影響**: ダッシュボード、ホーム画面で使用

3. **レシート画像の自動認識・入力**
   - **依存**: Sprint 1の支出記録API（保存するため）

4. **ダッシュボード画面の実装**
   - **依存**: 
     - 履歴表示機能（データ表示）
     - 予算設定機能（予算表示・設定）
     - Sprint 1の分析機能（分析機能の入口）

5. **ホーム画面の拡張**
   - **依存**: 
     - 履歴表示機能（内訳表示）
     - 予算設定機能（予算情報）

### 高優先度の依存関係

6. **サービス名正規化機能**
   - **依存**: なし（独立）
   - **影響**: レシート画像認識や支出記録時に使用可能

7. **評価機能**
   - **依存**: 履歴表示機能（既存の支出アイテムに評価を付けるため）

8. **カテゴリ分類機能**
   - **依存**: Sprint 1の支出記録API（カテゴリ選択の拡張）
   - **影響**: ダッシュボードのカテゴリ別集計に使用

### 中優先度の依存関係

9. **明細書解析機能の拡張**
   - **依存**: レシート画像の自動認識・入力（拡張版）

10. **キーワード検索機能**
    - **依存**: 履歴表示機能（検索対象）

11. **検出履歴管理**
    - **依存**: レシート画像の自動認識・入力、明細書解析機能（履歴を保存するため）

12. **週次サマリー機能**
    - **依存**: 
      - 履歴表示機能（データ集計）
      - 予算設定機能（予算情報）

### 低優先度

13. **レポート機能**
    - **依存**: 
      - 履歴表示機能（データ集計）
      - 予算設定機能（予算情報）

### 依存関係のイメージ図

```
Sprint 1の基盤機能
  │
  ├─→ 履歴表示機能
  │     │
  │     ├─→ ダッシュボード画面
  │     ├─→ ホーム画面の拡張
  │     ├─→ 評価機能
  │     ├─→ キーワード検索機能
  │     └─→ 週次サマリー機能
  │           └─→ レポート機能
  │
  ├─→ 予算設定機能
  │     │
  │     ├─→ ダッシュボード画面
  │     ├─→ ホーム画面の拡張
  │     └─→ 週次サマリー機能
  │
  ├─→ レシート画像の自動認識・入力
  │     │
  │     ├─→ 明細書解析機能の拡張
  │     └─→ 検出履歴管理
  │
  └─→ カテゴリ分類機能
        │
        └─→ ダッシュボード画面
```

---

## ✅ 決定事項（2026/02/09 確認済み）

### 1. スコープの優先順位
- ✅ **合意済み**: 上記の優先度で進める

### 2. 11期機能統合の進め方
- ✅ **エッセンスのみ**: 既存のコード（MOF、wasabimonja、くんよみ）のエッセンスを参考に実装
- 完全コピーではなく、エッセンスを抽出して実装

### 3. 週次サマリー機能
- ✅ **メール配信はSprint 3に延期**: ベロシティを考慮し、Sprint 2ではレポート生成のみ
- Sprint 2では週次レポートの自動生成とホーム画面への表示まで

### 4. カテゴリ分類機能
- ✅ **支出記録時のカテゴリ選択のみ**: カテゴリマスターの管理機能は除外
- カテゴリマスター管理機能は複雑なため、Sprint 2のスコープから外す
- **カテゴリ色分け（食費、日用品、趣味娯楽、交通費、水道光熱費、二分類）を採用**（議事録より）

### 5. ホーム画面の拡張
- ✅ **ホームに内訳を追加**: コーチ重視の体験とのバランスで一旦試験的に入れる

---

**参照**: [基本要件定義書](../requirements/基本要件定義書.md) | [機能一覧](../requirements/機能一覧.md) | [Sprint 1 タスク分割](./task_breakdown_sprint1.md) | [ミーティング議事録](../minutes/2026024_class4_meeting_1.md)  
**作成日**: 2026年2月9日  
**最終更新**: 2026年2月9日（スコープ合意完了）  
**ステータス**: 正式版（スコープ確定済み）
