# Sprint 0 タスク分割案

## Sprint 0の目標

**2/4（Sprint 1開始）に「テーブルとモックが揃った状態」で開発を始められるようにする**

- 機能一覧・データ定義を先に固める
- テーブルは Sprint 0 で作成しておく（途中マイグレーションを避ける）
- フロントの見た目・遷移が分かるモック／プロトタイプを用意する

**完了の定義**:
- 機能一覧ドキュメントが存在し、チームで共有されている
- データ定義・テーブル定義が確定し、Sprint 1 用 / Sprint 2 用の切り分けが明記されている
- Azure MySQL 上に必要なテーブルが作成されている（マイグレーション実行済み）
- モック／プロトタイプが存在し、Sprint 1 の実装指針として使える
- 基本要件定義書が確定している

**参照**: [基本要件定義書](../requirements/基本要件定義書.md) の「Sprint 0」「3. データモデル」「9.4. 開発方針（データベース）」

---

## フェーズ0: 機能一覧・データ定義（ドキュメント整備）

### 0-1. 機能一覧の作成・確定
**所要時間**: 1〜2時間  
**担当**: @しゅんすけ  
**内容**:
- 必須機能（Sprint 1）と追加機能（Sprint 2以降）の一覧化
- 基本要件定義書「2. 機能要件」をベースに、**実装単位**で整理（API・画面・バッチ等）
- 成果物: `docs/tasks/機能一覧.md`（または `docs/requirements/機能一覧.md`）の作成・更新

**完了条件**:
- 機能一覧ドキュメントが存在する
- Sprint 1 で実装する機能と Sprint 2 で実装する機能が一覧で分かる
- 必要に応じてチームで内容を確認し、確定している

---

### 0-2. データ定義・テーブル定義の確定
**所要時間**: 1〜2時間  
**担当**: @しゅんすけ（推奨：0-2 を他メンバーに任せると 1-1/1-2 が 0-2 完了までブロックされるため、しゅんすけがやり切る案を推奨）  
**依存**: 0-1 完了後（並行も可）  
**内容**:
- 基本要件定義書「3. データモデル」をベースに、全テーブル定義を確定
- **Sprint 1 で使うテーブル**と**Sprint 2 で追加するテーブル**の切り分けを明記
  - Sprint 1 想定: `users`, `expenses`, `budgets` 等
  - Sprint 2 想定: `expense_evaluations`, `categories`, `keywords`, `receipt_images`, `detection_histories`, `history_subscriptions` 等
- 成果物: `docs/requirements/データ定義.md` または 基本要件定義書内の「3. データモデル」に切り分け表を追記

**完了条件**:
- 全テーブルの定義が確定している
- 「Sprint 0 で作成するテーブル一覧」が明記されている
- リレーション・制約が要件定義書と矛盾していない

---

### 0-3. 基本要件定義書の最終確認
**所要時間**: 30分〜1時間  
**担当**: @よこち  
**依存**: 0-1, 0-2 完了後  
**内容**:
- 基本要件定義書の全体レビュー
- 機能一覧・データ定義との整合性確認
- 誤字・リンク切れ・日付の確認
- 必要に応じて軽微な修正を反映

**完了条件**:
- 基本要件定義書が「確定版」として扱える状態になっている
- 参照している他ドキュメント（PROJECT_CONTEXT、11期分析等）との齟齬がない

---

## フェーズ1: テーブル作成・マイグレーション

### 1-1. バックエンドプロジェクト・DB接続の準備
**所要時間**: 30分〜1時間  
**担当**: @よこち  
**依存**: 0-2 完了後  
**内容**:
- `backend/` 配下に FastAPI プロジェクト構造を作成（未作成の場合）
- `requirements.txt` の作成（FastAPI, SQLAlchemy, PyMySQL, Alembic 等）
- データベース接続設定（SQLAlchemy）
- 環境変数による接続情報の管理（`.env` の例・README の記載）
- **開発用 DB** への接続テスト（ローカル MySQL / Docker、または Azure の開発用 MySQL。**本番 DB には Sprint 0 では繋がない**）

**完了条件**:
- `backend/` から開発用 DB に接続できる
- 環境変数で接続情報を管理できる（開発用 / 本番用の切り替えが可能な形にしておく）

---

### 1-2. DBモデル定義（Sprint 0 で作成するテーブル）
**所要時間**: 1〜2時間  
**担当**: @よこち  
**依存**: 1-1 完了後  
**内容**:
- SQLAlchemy モデルの定義（0-2 で確定したデータ定義に基づく）
- Sprint 0 で作成するテーブルに限定してモデルを実装
  - 例: `users`, `expenses`, `budgets` および Sprint 2 で使うテーブルも含めて一括作成するか、Sprint 1 用のみにするかは 0-2 の切り分けに従う
- リレーションシップの定義
- Alembic の初期化（マイグレーション環境のセットアップ）

**完了条件**:
- 対象テーブルのモデルがすべて定義されている
- `alembic revision --autogenerate` 等でマイグレーションが生成できる

---

### 1-3. マイグレーションの実行・テーブル作成
**所要時間**: 30分〜1時間  
**担当**: @よこち  
**依存**: 1-2 完了後  
**内容**:
- 確定した定義で**開発用 DB**上にマイグレーションを実行（本番 DB には Sprint 0 では適用しない）
- テーブルが作成されていることを確認（接続ツール or 簡易スクリプト）
- マイグレーション履歴がリポジトリにコミットできる状態にする
- ※本番用 Azure MySQL へのマイグレーション適用は、デプロイ時・リリース時などに別途行う

**完了条件**:
- 開発用 DB 上に必要なテーブルが作成されている
- マイグレーション履歴が `backend/` 等で管理されている
- ドキュメント（README または setup）に「マイグレーションの実行手順」が書かれている（任意だが推奨）

---

## フェーズ2: モック／プロトタイプ

### 2-1. モック／プロトタイプの作成
**所要時間**: 1〜3時間（ツール・慣れによる）  
**担当**: @なおみん  
**依存**: 0-1 完了後（並行可能）  
**内容**:
- フロントエンドの見た目・遷移が分かるモック／プロトタイプを作成
- ツール: Figma make または ソースコード生成ツール 等
- 対象: ホーム画面（支出記録・分析）を中心に、Sprint 1 の実装指針になるレベル
  - 入力フォーム（ユーザー名、アイテム名、金額）
  - 記録ボタン
  - 分析ボタン（鬼コーチ / 天使コーチ）
  - 結果表示エリア
- 成果物: Figma のリンク、または静的 HTML/Next のモックリポジトリ／ブランチ

**完了条件**:
- モック／プロトタイプが存在し、URL またはパスで共有できる
- Sprint 1 で「この見た目で実装する」と参照できる状態になっている

---

### 2-2. モックの共有・確認
**所要時間**: 30分  
**担当**: @なおみん  
**依存**: 2-1 完了後  
**内容**:
- チームへのモック共有（Slack 等）
- 簡単なフィードバックの収集（あれば）
- 大きな変更がなければ「Sprint 1 の実装指針」として確定

**完了条件**:
- チームがモックを確認できる
- Sprint 1 開始時に「何を実装するか」の共通認識がある

---

## 並行作業の可能性

- **0-1（機能一覧）** と **0-2（データ定義）** は並行可能（しゅんすけが両方やる場合は順番でも可）
- **2-1（モック作成）** は 0-1 が終わっていれば 0-2 や フェーズ1 と並行可能
- **フェーズ1（1-1 〜 1-3）** は 0-2 確定後でないと進めないため、直列

---

## 依存関係のイメージ

```
0-1 機能一覧 ─┬─→ 0-3 要件定義書最終確認
              │
0-2 データ定義 ─┼─→ 1-1 → 1-2 → 1-3（テーブル作成）
              │
              └─→ 2-1 → 2-2（モック）
```

---

## リスクと対策

### リスク1: Azure MySQL の準備が遅れる
**対策**: ローカル MySQL または Docker で先にマイグレーションを実行し、後で Azure に接続し直す。

### リスク2: テーブル定義の見直しが発生する
**対策**: 0-2 で Sprint 1 用と Sprint 2 用を明確に切り分け、Sprint 0 では「Sprint 1 で使うテーブル」を優先して作成する。Sprint 2 用は後から追加マイグレーションでも可（0-2 で方針を書いておく）。

### リスク3: モック作成に時間がかかる
**対策**: 完璧でなくても「配置とラベルが分かる」レベルでよい。Figma make 等で素早く出し、Sprint 1 で実装しながら調整する。

---

## 優先順位（時間が足りない場合）

### 最優先（Sprint 0 で必須）
1. 0-1 機能一覧の作成・確定
2. 0-2 データ定義・テーブル定義の確定
3. 1-1 バックエンド・DB接続の準備
4. 1-2 DBモデル定義
5. 1-3 マイグレーション実行・テーブル作成

### 次優先（Sprint 1 をスムーズにしたい）
6. 2-1 モック／プロトタイプの作成
7. 0-3 基本要件定義書の最終確認

### できれば
8. 2-2 モックの共有・確認

---

## 次のステップ

1. 本タスク分割案をチームで確認する
2. 担当者・期限を確定する（Sprint 0 は 〜2/3）
3. 必要に応じて GitHub の Issue に落とし込む
4. Sprint 0 完了後、Sprint 1 タスク分割（`task_breakdown_sprint1.md`）を作成し、2/4 から開発開始

---

**参照**: [基本要件定義書](../requirements/基本要件定義書.md) | [プロジェクトコンテキスト](../reference/PROJECT_CONTEXT.md)  
**作成日**: 2026年1月28日
