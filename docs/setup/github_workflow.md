# GitHub開発ワークフロー手順書

## はじめに

このドキュメントは、GitHubを使った開発が初めて・2回目の方向けに、基本的な開発の流れをわかりやすく説明します。

**重要**: わからないことがあったら、遠慮せずに質問してください！

---

## 目次

1. [GitHubの基本用語](#githubの基本用語)
2. [開発の全体フロー](#開発の全体フロー)
3. [ステップバイステップ手順](#ステップバイステップ手順)
4. [よくある質問](#よくある質問)
5. [トラブルシューティング](#トラブルシューティング)

---

## GitHubの基本用語

### Issue（イシュー）
**役割**: やるべきタスクやバグを記録するチケット

- 例: 「[フェーズ1] ドキュメント一覧取得API」
- 各Issueには番号がついています（#1, #2, #3...）
- Issueには「目的」「スコープ」「完了条件」などが書かれています

### Branch（ブランチ）
**役割**: メインのコードを壊さないように、別の場所で作業するための「枝」

- `main`: 本番環境にデプロイされるコード（触らない！）
- `feature/xxx`: 新機能を開発するためのブランチ
- `fix/xxx`: バグ修正用のブランチ

### Pull Request（PR、プルリクエスト）
**役割**: 自分の変更を`main`に取り込んでもらうための「申請書」

- コードレビューをしてもらう場所
- レビューOKになったら`main`にマージ（統合）される

### Merge（マージ）
**役割**: ブランチの変更を`main`に統合すること

- PRが承認されると、ブランチの変更が`main`に取り込まれます

---

## 開発の全体フロー

```
1. Issueを選ぶ
   ↓
2. ブランチを作成する
   ↓
3. コードを書く
   ↓
4. コミット・プッシュする
   ↓
5. Pull Requestを作成する
   ↓
6. レビューしてもらう
   ↓
7. 修正（必要に応じて）
   ↓
8. マージされる
   ↓
9. 完了！
```

---

## ステップバイステップ手順

### ステップ1: Issueを選ぶ

1. GitHubのリポジトリページを開く
2. 「Issues」タブをクリック
3. 自分が担当するIssueを探す
   - アサインされているIssueが自分のタスク
   - アサインされていないIssueは、他の人と相談してから選ぶ
4. Issueにステータスラベルを確認・更新する
   - 作業開始時: `⛰️ Uphill`（デフォルト、悩み中）
   - 作業が順調なとき: `⛷️ Downhill`（作業中）に更新

**ステータスラベルの使い方（Shape Up方式）**:
- **デフォルト**: Issue作成時や作業開始時は `⛰️ Uphill` を付与（最初はどうしていいかわからないため）
- **状態が変わったら**: 自分でラベルを更新
  - 悩んでいるとき → `⛰️ Uphill`
  - 作業が順調なとき → `⛷️ Downhill`
- **PdMのアクション**:
  - `⛰️ Uphill` が付いているIssue → 声をかけて壁打ち相手になる
  - `⛷️ Downhill` が付いているIssue → 完全に放置する（順調な証拠）

**例**: Issue #7「[フェーズ1] ドキュメント一覧取得API」を選んだとします

---

### ステップ2: 最新のコードを取得する

作業を始める前に、必ず最新のコードを取得しましょう。

```bash
# リポジトリのディレクトリに移動
cd /Users/shunsukeshimojo/Downloads/project_team11

# 最新のコードを取得
git fetch origin
git checkout main
git pull origin main
```

**なぜ必要？**: 他の人が追加したコードを反映させるため

---

### ステップ3: ブランチを作成する

Issueごとにブランチを作成します。

**ブランチ名のルール**:
- `feature/issue-{番号}-{簡潔な説明}`
- 例: `feature/issue-7-document-list-api`

```bash
# ブランチを作成して移動
git checkout -b feature/issue-7-document-list-api
```

**確認方法**:
```bash
# 現在のブランチを確認
git branch
# * feature/issue-7-document-list-api  ← これが表示されればOK
```

---

### ステップ4: コードを書く

エディタでコードを書きます。

**注意点**:
- Issueの「スコープ」に書かれている内容を実装する
- わからないことがあったら、Issueにコメントを書いて質問する

---

### ステップ5: 変更をコミットする

コードを書いたら、変更を「コミット」します。

**コミットメッセージのルール**:
- `[Issue #{番号}] {簡潔な説明}`
- 例: `[Issue #7] ドキュメント一覧取得APIを実装`

```bash
# 変更されたファイルを確認
git status

# 変更をステージング（コミット準備）
git add .

# コミット
git commit -m "[Issue #7] ドキュメント一覧取得APIを実装"
```

**コミットのタイミング**:
- 1つの機能が完成したらコミット
- 1日に何回コミットしてもOK（むしろ推奨）

---

### ステップ6: ブランチをプッシュする

ローカルの変更をGitHubにアップロードします。

```bash
# 初回プッシュ（ブランチをリモートに作成）
git push -u origin feature/issue-7-document-list-api

# 2回目以降（同じブランチに追加でプッシュする場合）
git push
```

---

### ステップ7: Pull Requestを作成する

1. GitHubのリポジトリページを開く
2. 「Pull requests」タブをクリック
3. 「New pull request」をクリック
4. 以下の情報を入力：
   - **Base**: `main`（変更先）
   - **Compare**: `feature/issue-7-document-list-api`（自分のブランチ）
   - **タイトル**: `[Issue #7] ドキュメント一覧取得APIを実装`
   - **説明**: Issueの内容を簡単に説明

**PRの説明テンプレート**:
```markdown
## 実装内容
- ドキュメント一覧取得API（GET /api/documents）を実装
- ジャンルフィルタ、ステータスフィルタに対応

## 関連Issue
Closes #7

## 動作確認
- [ ] ローカルで動作確認済み
- [ ] エラーハンドリングを実装済み
```

5. 「Create pull request」をクリック

**重要**: PRを作成したら、**必ずラベルを付けましょう**

#### ラベルの付け方

1. PRページを開く（作成直後、またはPR一覧から）
2. 右側の「Labels」セクションをクリック
3. 該当するラベルを選択：

   **カテゴリ（どれか1つ）**:
   - **`backend`**: バックエンド関連のタスク
   - **`frontend`**: フロントエンド関連のタスク
   - **`documentation`**: ドキュメント関連

   **種類（どれか1つ）**:
   - **`task`**: 開発タスク全般
   - **`bug`**: バグ修正
   - **`enhancement`**: 機能追加・改善

   **優先度（必要に応じて）**:
   - **`high-priority`**: 優先度が高い
   - **`low-priority`**: 優先度が低い

**例**: Issue #7「[フェーズ1] ドキュメント一覧取得API」のPRの場合
- `backend`（カテゴリ）と `task`（種類）を選択

**注意**: ラベルを付け忘れた場合でも、後から追加できます。PRページの右側からいつでも編集可能です。

---

### ステップ8: レビューを待つ

- 他のメンバーがコードをレビューします
- コメントがついたら、修正して再度プッシュします

**修正の流れ**:
```bash
# コードを修正
# ...（エディタで修正）...

# 変更をコミット
git add .
git commit -m "[Issue #7] レビュー指摘を修正"

# プッシュ（PRが自動的に更新される）
git push
```

---

### ステップ9: マージされる

- レビューがOKになったら、マージされます
- マージ後、ブランチは削除されます（自動）

**マージ後の確認**:
```bash
# mainブランチに戻る
git checkout main

# 最新のコードを取得
git pull origin main

# 作業ブランチを削除（ローカル）
git branch -d feature/issue-7-document-list-api
```

---

## よくある質問

### Q1: どのIssueを選べばいい？

**A**: 以下の順番で選びましょう：
1. 自分にアサインされているIssue
2. 依存関係がないIssue（「依存関係」欄が空）
3. 依存関係が完了しているIssue

**例**: Issue #7は「依存関係: #3が完了していること」と書かれているので、#3が完了してから取り組みます。

---

### Q2: ブランチ名はどう決める？

**A**: 以下のルールに従ってください：
- `feature/issue-{番号}-{簡潔な説明}`
- 例: `feature/issue-7-document-list-api`
- 例: `feature/issue-12-list-page-api-connection`

**注意**: ブランチ名に日本語は使わないでください。

---

### Q3: コミットはどのタイミングでする？

**A**: 以下のタイミングでコミットしましょう：
- ✅ 1つの機能が完成したら
- ✅ 動作確認ができたら
- ✅ 1日の作業が終わったら

**1つのPRに複数のコミットがあってもOK**です。

---

### Q4: 他の人が同じファイルを編集していたら？

**A**: コンフリクト（競合）が発生する可能性があります。

**対処法**:
1. 作業を始める前に`git pull origin main`で最新を取得
2. それでもコンフリクトしたら、Issueにコメントして相談

**重要**: 同じファイルを同時に編集しないよう、担当を分けましょう。

---

### Q5: PRのレビューで何を確認される？

**A**: 以下の点を確認されます：
- ✅ Issueの要件を満たしているか
- ✅ コードが正しく動作するか
- ✅ エラーハンドリングが適切か
- ✅ コードの書き方が統一されているか

**指摘されたら**:
- 修正して再度プッシュ
- わからなかったら質問する

---

### Q6: マージ後、何をすればいい？

**A**: 以下の手順でクリーンアップします：
```bash
# mainブランチに戻る
git checkout main

# 最新のコードを取得
git pull origin main

# 作業ブランチを削除（ローカル）
git branch -d feature/issue-7-document-list-api
```

---

## トラブルシューティング

### 問題1: `git pull`でエラーが出る

**エラー例**:
```
error: Your local changes to the following files would be overwritten by merge
```

**原因**: ローカルに未コミットの変更がある

**解決法**:
```bash
# 変更を一時的に退避
git stash

# 最新を取得
git pull origin main

# 退避した変更を戻す
git stash pop
```

---

### 問題2: 間違ったブランチで作業してしまった

**解決法**:
```bash
# 変更を退避
git stash

# 正しいブランチに移動
git checkout feature/issue-7-document-list-api

# 変更を戻す
git stash pop
```

---

### 問題3: コミットメッセージを間違えた

**解決法**:
```bash
# 直前のコミットメッセージを修正（まだプッシュしていない場合）
git commit --amend -m "正しいメッセージ"

# プッシュ（強制プッシュが必要）
git push --force-with-lease
```

**注意**: 既にPRを作成している場合は、強制プッシュしてもOKです。

---

### 問題4: 不要なファイルをコミットしてしまった

**解決法**:
```bash
# .gitignoreに追加
echo "不要なファイル名" >> .gitignore

# コミットから削除（ファイル自体は残る）
git rm --cached 不要なファイル名

# 再コミット
git commit -m "[Issue #7] .gitignoreを更新"
git push
```

---

### 問題5: PRがマージされたけど、ローカルのブランチが残っている

**解決法**:
```bash
# mainブランチに戻る
git checkout main

# 最新を取得
git pull origin main

# 不要なブランチを削除
git branch -d feature/issue-7-document-list-api
```

---

## チェックリスト

### 作業を始める前
- [ ] 最新のコードを取得した（`git pull origin main`）
- [ ] 正しいブランチを作成した
- [ ] Issueの内容を理解した

### コードを書いた後
- [ ] 動作確認をした
- [ ] コミットメッセージを書いた
- [ ] プッシュした

### PRを作成する前
- [ ] ローカルで動作確認した
- [ ] コミットメッセージが適切か確認した
- [ ] PRの説明を書いた

### PRがマージされた後
- [ ] mainブランチに戻った
- [ ] 最新のコードを取得した
- [ ] 作業ブランチを削除した

---

## まとめ

1. **Issueを選ぶ** → 自分が担当するタスクを確認
2. **ブランチを作る** → `feature/issue-{番号}-{説明}`
3. **コードを書く** → Issueの要件を満たす
4. **コミット・プッシュ** → 変更を保存・アップロード
5. **PRを作る** → レビューを依頼
6. **修正（必要に応じて）** → 指摘を反映
7. **マージ** → 完了！

**わからないことがあったら、遠慮せずに質問してください！**

---

## 参考リンク

- [プロジェクト構造と開発フロー](./project_structure.md)
- [Week 1タスク分割](../tasks/task_breakdown_week1.md)
- [GitHub公式ドキュメント](https://docs.github.com/ja)

