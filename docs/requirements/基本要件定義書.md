# 基本要件定義書

## 1. プロジェクト概要

### 目的
12期生が作成したアプリ（gen12）をベースに、11期レベルの「型安全性」「AI駆動ワークフロー」「洗練されたUI/UX」を注入し、プロダクトとして一段上の完成度へ引き上げる。

### 技術スタック
- **フロントエンド**: Next.js + TypeScript + Tailwind CSS
- **バックエンド**: FastAPI + Python
- **データベース**: Azure MySQL
- **デプロイ**: Azure
- **AI機能**: OpenAI API（継続利用）

---

## 2. 機能要件

### 2.1. 必須機能（Sprint 1で完了目標）

gen12の機能を11期レベルで再実装する。

#### 2.1.1. 支出記録機能
- **概要**: ユーザー名、アイテム名、金額を入力して記録
- **エンドポイント**: `POST /api/expenses`
- **機能詳細**:
  - ユーザー名、アイテム名、金額の入力
  - 日付の自動記録（現在日時）
  - データベースへの保存
- **gen12との違い**:
  - CSV → データベース（Azure MySQL）に変更
  - 型安全性の確保（TypeScript + Pydantic）
  - エラーハンドリングの強化

#### 2.1.2. 分析機能（AIコーチング）
- **概要**: ユーザー別の合計金額を計算し、AIコーチングを提供
- **エンドポイント**: `GET /api/analyze?user={user}&coach={coach}`
- **機能詳細**:
  - 指定ユーザーの合計金額を計算
  - AIコーチング機能（鬼コーチ/天使コーチ）
  - 目標支出額との比較
- **コーチタイプ**:
  - `oni`: 鬼コーチ（厳しい指導）
  - `tenshi`: 天使コーチ（優しい指導）
- **gen12との違い**:
  - データベースからの集計（CSV → DB）
  - 予算設定の柔軟化（ハードコード → DB保存）

#### 2.1.3. 基本UI
- **概要**: 支出記録と分析結果を表示する画面
- **画面構成**:
  - 入力フォーム（ユーザー名、アイテム名、金額）
  - 分析ボタン（鬼コーチ/天使コーチ）
  - 結果表示エリア
- **gen12との違い**:
  - モダンなUI/UX（Next.js + Tailwind CSS）
  - レスポンシブ対応
  - 型安全なコンポーネント（TypeScript）

### 2.2. 追加実装機能（Sprint 2以降）

#### 2.2.1. 履歴表示機能
- **概要**: 記録した支出の一覧を表示
- **エンドポイント**: `GET /api/expenses?user={user}`
- **機能詳細**:
  - ユーザー別の支出履歴一覧
  - 日付順でのソート
  - ページネーション（必要に応じて）

#### 2.2.2. 予算設定機能
- **概要**: ユーザーごとの月次予算を設定・管理
- **エンドポイント**: 
  - `POST /api/budgets`（予算設定）
  - `GET /api/budgets?user={user}`（予算取得）
- **機能詳細**:
  - 月次予算の設定・更新
  - 予算と実績の比較表示
  - 予算超過時のアラート

#### 2.2.3. レシート画像の自動認識・入力（11期機能統合）
- **概要**: レシート画像を撮影して支出情報を自動入力
- **エンドポイント**: `POST /api/receipts/analyze`
- **機能詳細**:
  - 画像ファイル（PNG, JPG, JPEG）のアップロード
  - GPT-4 Vision APIによる画像解析
  - アイテム名、金額、日付の自動抽出
  - 抽出結果の確認・編集機能
- **実装参考**: MOFの`pdf_analyzer.py`と`ai_judge.py`
- **優先度**: ⭐⭐⭐⭐⭐（最高優先度）

#### 2.2.4. サービス名正規化機能（11期機能統合）
- **概要**: CSV解析時のサービス名を正規化して検出精度を向上
- **機能詳細**:
  - 500以上のサービス名マッピング（Netflix, Spotify, Adobe等）
  - 表記揺れ対応（全角/半角、記号統一）
  - 部分一致検索（誤爆防止機能付き）
- **実装参考**: wasabimonjaの`normalize_service_name`関数
- **優先度**: ⭐⭐⭐⭐⭐（最高優先度）

#### 2.2.5. 明細書解析機能の拡張（11期機能統合）
- **概要**: PDF・画像・CSVの統合解析と定期性パターン検出
- **エンドポイント**: `POST /api/analyze/files`（拡張版）
- **機能詳細**:
  - PDF明細書の解析対応（PyMuPDF使用）
  - 画像明細書の解析対応（OCR精度向上処理付き）
  - CSVから自動で定期支払いを検出（月次間隔25-35日）
  - 未知のサブスク発見機能
- **実装参考**: wasabimonjaの明細書解析機能
- **優先度**: ⭐⭐⭐⭐（高優先度）

#### 2.2.6. 評価機能（11期機能統合）
- **概要**: 各支出アイテムに対して「役立ったか」を評価
- **エンドポイント**: 
  - `POST /api/expenses/{expense_id}/evaluate`
  - `GET /api/expenses/{expense_id}/evaluation`
- **機能詳細**:
  - 支出アイテムごとの評価（役立った/役立たなかった）
  - 評価スコアの集計・表示
  - 「おすすめの支出」機能（評価スコアに基づく）
  - 満足度の高い支出パターンの分析
- **実装参考**: くんよみの`DocumentEvaluation`モデル
- **優先度**: ⭐⭐⭐⭐⭐（高優先度）

#### 2.2.7. カテゴリ分類機能（11期機能統合）
- **概要**: 支出をカテゴリで分類・管理
- **エンドポイント**: 
  - `GET /api/categories`
  - `POST /api/categories`
  - `PUT /api/expenses/{expense_id}/category`
- **機能詳細**:
  - カテゴリマスターの管理（階層構造対応）
  - 支出記録時のカテゴリ選択
  - カテゴリ別の支出集計
  - カテゴリごとの予算管理
- **実装参考**: くんよみの`genres`テーブル構造
- **優先度**: ⭐⭐⭐⭐（中優先度）

#### 2.2.8. キーワード検索機能（11期機能統合）
- **概要**: 支出履歴のキーワード検索
- **エンドポイント**: `GET /api/expenses/search?keyword={keyword}`
- **機能詳細**:
  - キーワードによる支出履歴の検索
  - 正規化処理により表記揺れに対応（「コーヒー」「coffee」等を同一視）
  - 検索結果のハイライト表示
- **実装参考**: くんよみのキーワード検索機能
- **優先度**: ⭐⭐⭐⭐（中優先度）

#### 2.2.9. 検出履歴管理（11期機能統合）
- **概要**: 明細書解析結果の履歴を保存・参照
- **エンドポイント**: 
  - `GET /api/detection-histories`
  - `GET /api/detection-histories/{history_id}`
  - `PUT /api/detection-histories/{history_id}`
- **機能詳細**:
  - 解析履歴の保存（アップロードファイル数、検出数、合計金額等）
  - 履歴一覧の表示（ページネーション対応）
  - 履歴詳細の表示
  - 解約ステータスの管理（チェックボックス）
- **実装参考**: wasabimonjaの`DetectionHistory`モデル
- **優先度**: ⭐⭐⭐⭐（中優先度）

#### 2.2.10. レポート機能（オプション）
- **概要**: 月次/年次の支出レポート
- **機能詳細**:
  - 月次集計の表示
  - グラフ表示（チャートライブラリ使用）
  - トレンド分析

---

## 3. データモデル

### 3.1. テーブル設計

#### 3.1.1. users テーブル
| カラム名 | 型 | 制約 | 説明 |
|---------|-----|------|------|
| id | INT | PRIMARY KEY, AUTO_INCREMENT | ユーザーID |
| username | VARCHAR(255) | UNIQUE, NOT NULL | ユーザー名 |
| created_at | DATETIME | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 作成日時 |
| updated_at | DATETIME | NOT NULL, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP | 更新日時 |

#### 3.1.2. expenses テーブル
| カラム名 | 型 | 制約 | 説明 |
|---------|-----|------|------|
| id | INT | PRIMARY KEY, AUTO_INCREMENT | 支出ID |
| user_id | INT | FOREIGN KEY (users.id), NOT NULL | ユーザーID |
| item | VARCHAR(255) | NOT NULL | アイテム名 |
| price | INT | NOT NULL | 金額 |
| expense_date | DATE | NOT NULL | 支出日（デフォルト: 現在日） |
| created_at | DATETIME | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 作成日時 |
| updated_at | DATETIME | NOT NULL, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP | 更新日時 |

#### 3.1.3. budgets テーブル
| カラム名 | 型 | 制約 | 説明 |
|---------|-----|------|------|
| id | INT | PRIMARY KEY, AUTO_INCREMENT | 予算ID |
| user_id | INT | FOREIGN KEY (users.id), UNIQUE, NOT NULL | ユーザーID |
| monthly_budget | INT | NOT NULL | 月次予算額 |
| created_at | DATETIME | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 作成日時 |
| updated_at | DATETIME | NOT NULL, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP | 更新日時 |

#### 3.1.4. expense_evaluations テーブル（11期機能統合）
| カラム名 | 型 | 制約 | 説明 |
|---------|-----|------|------|
| id | INT | PRIMARY KEY, AUTO_INCREMENT | 評価ID |
| expense_id | INT | FOREIGN KEY (expenses.id), NOT NULL | 支出ID |
| user_id | INT | FOREIGN KEY (users.id), NOT NULL | ユーザーID |
| is_helpful | BOOLEAN | NOT NULL | 役立ったか（true/false） |
| created_at | DATETIME | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 作成日時 |
| **UNIQUE制約**: (expense_id, user_id) | | | 1ユーザー1支出につき1評価 |

#### 3.1.5. categories テーブル（11期機能統合）
| カラム名 | 型 | 制約 | 説明 |
|---------|-----|------|------|
| id | INT | PRIMARY KEY, AUTO_INCREMENT | カテゴリID |
| name | VARCHAR(255) | NOT NULL | カテゴリ名 |
| parent_id | INT | FOREIGN KEY (categories.id), NULL | 親カテゴリID（階層構造用） |
| path | VARCHAR(500) | NULL | 階層パス（例: "1/5/23"） |
| level | INT | DEFAULT 0 | 階層レベル |
| display_order | INT | DEFAULT 0 | 表示順序 |
| is_active | BOOLEAN | DEFAULT TRUE | 有効フラグ |
| created_at | DATETIME | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 作成日時 |

#### 3.1.6. keywords テーブル（11期機能統合）
| カラム名 | 型 | 制約 | 説明 |
|---------|-----|------|------|
| id | INT | PRIMARY KEY, AUTO_INCREMENT | キーワードID |
| name | VARCHAR(255) | NOT NULL | キーワード名 |
| normalized_name | VARCHAR(255) | NOT NULL, INDEX | 正規化済みキーワード名 |
| usage_count | INT | DEFAULT 1 | 使用回数 |
| created_at | DATETIME | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 作成日時 |

#### 3.1.7. expense_keywords テーブル（11期機能統合）
| カラム名 | 型 | 制約 | 説明 |
|---------|-----|------|------|
| expense_id | INT | FOREIGN KEY (expenses.id), PRIMARY KEY | 支出ID |
| keyword_id | INT | FOREIGN KEY (keywords.id), PRIMARY KEY | キーワードID |
| created_at | DATETIME | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 作成日時 |

#### 3.1.8. receipt_images テーブル（11期機能統合）
| カラム名 | 型 | 制約 | 説明 |
|---------|-----|------|------|
| id | INT | PRIMARY KEY, AUTO_INCREMENT | 画像ID |
| expense_id | INT | FOREIGN KEY (expenses.id), NULL | 支出ID（紐付け後） |
| file_path | VARCHAR(500) | NOT NULL | ファイルパス |
| storage_url | VARCHAR(500) | NULL | ストレージURL（Azure Storage等） |
| analyzed_data | JSON | NULL | AI解析結果（JSON形式） |
| created_at | DATETIME | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 作成日時 |

#### 3.1.9. detection_histories テーブル（11期機能統合）
| カラム名 | 型 | 制約 | 説明 |
|---------|-----|------|------|
| id | VARCHAR(36) | PRIMARY KEY | UUID |
| user_id | INT | FOREIGN KEY (users.id), NOT NULL, INDEX | ユーザーID |
| uploaded_files_count | INT | NOT NULL | アップロードファイル数 |
| detected_subscriptions_count | INT | DEFAULT 0 | 検出されたサブスク数 |
| total_monthly_amount | INT | DEFAULT 0 | 月額合計金額 |
| created_at | DATETIME | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 作成日時 |
| updated_at | DATETIME | NOT NULL, DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP | 更新日時 |

#### 3.1.10. history_subscriptions テーブル（11期機能統合）
| カラム名 | 型 | 制約 | 説明 |
|---------|-----|------|------|
| id | VARCHAR(36) | PRIMARY KEY | UUID |
| detection_history_id | VARCHAR(36) | FOREIGN KEY (detection_histories.id), NOT NULL | 検出履歴ID |
| name | VARCHAR(255) | NOT NULL | サービス名 |
| monthly_price | INT | NULL | 月額価格 |
| yearly_price | INT | NULL | 年額価格 |
| category | VARCHAR(100) | NULL | カテゴリ |
| canceled | BOOLEAN | DEFAULT FALSE | 解約フラグ |
| confidence | FLOAT | NULL | 確信度（0.0-1.0） |
| official_url | VARCHAR(500) | NULL | 公式URL |
| cancel_url | VARCHAR(500) | NULL | 解約URL |
| raw_merchant | VARCHAR(500) | NULL | 明細表記（例: "GOOGLE*YOUTUBE"） |
| is_yearly_detected | BOOLEAN | DEFAULT FALSE | 年額検出フラグ |

### 3.2. expenses テーブルの拡張（11期機能統合）
既存の`expenses`テーブルに以下のカラムを追加：

| カラム名 | 型 | 制約 | 説明 |
|---------|-----|------|------|
| category_id | INT | FOREIGN KEY (categories.id), NULL | カテゴリID |
| helpful_count | INT | DEFAULT 0 | 役立った評価数 |
| helpfulness_score | FLOAT | DEFAULT 0.0 | 役立ちスコア（0.0-1.0） |
| raw_merchant | VARCHAR(500) | NULL | 明細表記（CSV解析時） |
| confidence | FLOAT | NULL | 確信度（AI解析時） |

### 3.3. リレーションシップ
- `expenses.user_id` → `users.id` (多対1)
- `budgets.user_id` → `users.id` (1対1)
- `expense_evaluations.expense_id` → `expenses.id` (多対1)
- `expense_evaluations.user_id` → `users.id` (多対1)
- `expenses.category_id` → `categories.id` (多対1)
- `categories.parent_id` → `categories.id` (自己参照)
- `expense_keywords.expense_id` → `expenses.id` (多対多)
- `expense_keywords.keyword_id` → `keywords.id` (多対多)
- `receipt_images.expense_id` → `expenses.id` (多対1)
- `detection_histories.user_id` → `users.id` (多対1)
- `history_subscriptions.detection_history_id` → `detection_histories.id` (多対1)

---

## 4. API設計

### 4.1. 支出記録API
```
POST /api/expenses
Request Body:
{
  "username": "string",
  "item": "string",
  "price": number
}
Response:
{
  "message": "string",
  "expense_id": number
}
```

### 4.2. 分析API
```
GET /api/analyze?user={username}&coach={oni|tenshi}
Response:
{
  "username": "string",
  "total_amount": number,
  "monthly_budget": number,
  "coach_message": "string"
}
```

### 4.3. 履歴取得API（追加機能）
```
GET /api/expenses?user={username}
Response:
{
  "expenses": [
    {
      "id": number,
      "item": "string",
      "price": number,
      "expense_date": "YYYY-MM-DD",
      "created_at": "YYYY-MM-DD HH:MM:SS"
    }
  ],
  "total": number
}
```

### 4.4. 予算設定API（追加機能）
```
POST /api/budgets
Request Body:
{
  "username": "string",
  "monthly_budget": number
}
Response:
{
  "message": "string",
  "budget_id": number
}
```

### 4.5. レシート画像解析API（11期機能統合）
```
POST /api/receipts/analyze
Request: multipart/form-data
  - file: File (PNG, JPG, JPEG)

Response:
{
  "success": boolean,
  "items": [
    {
      "item": "string",
      "price": number,
      "date": "YYYY-MM-DD",
      "category": "string",
      "confidence": number
    }
  ]
}
```

### 4.6. 評価API（11期機能統合）
```
POST /api/expenses/{expense_id}/evaluate
Request Body:
{
  "is_helpful": boolean
}
Response:
{
  "message": "string",
  "evaluation_id": number,
  "helpful_count": number,
  "helpfulness_score": number
}

GET /api/expenses/{expense_id}/evaluation
Response:
{
  "expense_id": number,
  "helpful_count": number,
  "helpfulness_score": number,
  "user_evaluation": boolean | null
}
```

### 4.7. カテゴリAPI（11期機能統合）
```
GET /api/categories
Response:
{
  "categories": [
    {
      "id": number,
      "name": "string",
      "parent_id": number | null,
      "path": "string",
      "level": number
    }
  ]
}

POST /api/categories
Request Body:
{
  "name": "string",
  "parent_id": number | null
}
Response:
{
  "message": "string",
  "category_id": number
}

PUT /api/expenses/{expense_id}/category
Request Body:
{
  "category_id": number
}
Response:
{
  "message": "string"
}
```

### 4.8. キーワード検索API（11期機能統合）
```
GET /api/expenses/search?keyword={keyword}&user={user}
Response:
{
  "expenses": [
    {
      "id": number,
      "item": "string",
      "price": number,
      "expense_date": "YYYY-MM-DD"
    }
  ],
  "total": number
}
```

### 4.9. 検出履歴API（11期機能統合）
```
GET /api/detection-histories?limit=20&offset=0
Response:
{
  "histories": [
    {
      "id": "string",
      "date": "string",
      "uploaded_files_count": number,
      "detected_subscriptions_count": number,
      "total_monthly_amount": number,
      "subscriptions": [...]
    }
  ],
  "total": number
}

GET /api/detection-histories/{history_id}
Response:
{
  "id": "string",
  "date": "string",
  "uploaded_files_count": number,
  "detected_subscriptions_count": number,
  "total_monthly_amount": number,
  "subscriptions": [...]
}

PUT /api/detection-histories/{history_id}
Request Body:
{
  "subscriptions": [
    {
      "id": "string",
      "canceled": boolean
    }
  ]
}
Response:
{
  "id": "string",
  ...
}
```

### 4.10. 明細書解析API（拡張版・11期機能統合）
```
POST /api/analyze/files
Request: multipart/form-data
  - files: File[] (PDF, PNG, JPG, JPEG, CSV)

Response:
{
  "success": boolean,
  "subscriptions": [
    {
      "name": "string",
      "raw_merchant": "string",
      "price": number,
      "monthly_price": number,
      "yearly_price": number,
      "category": "string",
      "confidence": number,
      "is_yearly_detected": boolean,
      "official_url": "string | null",
      "cancel_url": "string | null"
    }
  ],
  "message": "string"
}
```

---

## 5. UI/UX要件

### 5.1. デザイン方針
- **トーン**: モダンで洗練されたデザイン
- **カラーパレット**: 家計簿アプリに適した落ち着いた色調
- **タイポグラフィ**: 読みやすさを重視
- **レスポンシブ**: モバイル・タブレット・デスクトップ対応

### 5.2. 主要画面

#### 5.2.1. ホーム画面（支出記録・分析）
- 入力フォーム（ユーザー名、アイテム名、金額）
- 記録ボタン
- 分析ボタン（鬼コーチ/天使コーチ）
- 結果表示エリア

#### 5.2.2. 履歴画面（追加機能）
- 支出一覧テーブル
- フィルタリング機能（日付範囲、アイテム名）
- ページネーション

#### 5.2.3. 設定画面（追加機能）
- 予算設定フォーム
- 現在の予算表示

### 5.3. UI生成方法
- **ツール**: Figma make または ソースコード生成ツール

---

## 6. 「11期レベル」の定義

### 6.1. 必須項目

#### 6.1.1. 型安全性
- **フロントエンド**: TypeScript導入、厳密な型定義
- **バックエンド**: Pydanticモデルによる型検証
- **API**: リクエスト/レスポンスの型定義

#### 6.1.2. データベース化
- CSV → Azure MySQLへの移行
- ORM（SQLAlchemy）の使用
- マイグレーション管理（Alembic）

#### 6.1.3. エラーハンドリング
- 適切なエラーレスポンス
- バリデーションエラーの明確な表示
- ロギング機能

#### 6.1.4. レスポンシブ対応
- モバイルファーストデザイン
- タブレット・デスクトップ対応

### 6.2. 推奨項目

#### 6.2.1. テストコード
- 最低限のE2Eテスト
- APIのユニットテスト

#### 6.2.2. APIドキュメント
- Swagger/OpenAPIによる自動生成
- エンドポイントの説明

#### 6.2.3. 開発フロー
- GitHub Issue/PRベースの開発
- AI駆動のコードレビュー
- CI/CDパイプライン（可能な範囲で）

---

## 7. スプリント計画

### Sprint 0（〜2/3）

準備期。**機能一覧・データ定義を先に固め、テーブルは最初に作成する**。途中からのマイグレーションはチーム全体の整合を取りづらいため、Sprint 0 でスキーマを確定し、Sprint 1 では「テーブルを触らない前提」で開発を始められるようにする。

- [x] プロジェクト構造の整備
- [ ] **機能一覧の作成・確定**
  - 必須機能（Sprint 1）と追加機能（Sprint 2以降）の一覧化
  - 本ドキュメント「2. 機能要件」をベースに、実装単位で整理
- [ ] **データ定義・テーブル定義の確定**
  - 本ドキュメント「3. データモデル」をベースに、全テーブル定義を確定
  - Sprint 1 で使うテーブルと Sprint 2 で追加するテーブルの切り分けを明記
- [ ] **テーブルの作成（マイグレーション実行）**
  - 確定した定義で Azure MySQL 上にテーブルを作成
  - マイグレーション管理（Alembic 等）の初期セットアップ
  - ※途中からのマイグレーションを避けるため、必要なテーブルは Sprint 0 で作成しておく
- [ ] **モック／プロトタイプの作成**
  - フロントエンドの見た目・遷移が分かるもの（Figma make 等で生成）
  - ホーム画面（支出記録・分析）を中心に、Sprint 1 の実装指針になるレベル
- [ ] 基本要件定義書の確定（本ドキュメント）

### Sprint 1（2/4 〜 2/10）

Sprint 0 でテーブル・モックが揃っている前提で、必須機能の実装に集中する。

- [ ] 必須機能の実装
  - [ ] 支出記録機能
  - [ ] 分析機能（AIコーチング）
  - [ ] 基本UI（モックに沿った実装）
- [ ] Azure MySQL への接続確認・環境変数設定
- [ ] （テーブルは Sprint 0 で作成済みのため、新規マイグレーションは原則不要）

### Sprint 2（2/11 〜 2/17）
- [ ] 追加機能の実装
  - [ ] 履歴表示機能
  - [ ] 予算設定機能
  - [ ] **レシート画像の自動認識・入力**（最高優先度・11期機能統合）
  - [ ] **サービス名正規化機能**（最高優先度・11期機能統合）
  - [ ] **明細書解析機能の拡張**（高優先度・11期機能統合）
  - [ ] **評価機能**（高優先度・11期機能統合）
  - [ ] カテゴリ分類機能（中優先度・11期機能統合）
  - [ ] キーワード検索機能（中優先度・11期機能統合）
  - [ ] 検出履歴管理（中優先度・11期機能統合）
- [ ] UI/UXのブラッシュアップ
- [ ] Azureへのデプロイ
- [ ] 最終調整・テスト

---

## 8. 非機能要件

### 8.1. パフォーマンス
- APIレスポンス時間: 1秒以内（通常時）
- ページ読み込み時間: 3秒以内

### 8.2. セキュリティ
- SQLインジェクション対策（ORM使用）
- XSS対策（Reactのデフォルト機能）
- 環境変数による機密情報管理

### 8.3. 可用性
- AzureのSLAに準拠
- エラーハンドリングによる適切なエラーメッセージ表示

---

## 9. 制約事項

### 9.1. 技術的制約
- Azure MySQLを使用（データベース選択の制約）
- OpenAI APIの継続利用（gen12と同様）

### 9.2. スケジュール制約
- 最終納期: 2月17日
- チームメンバーの疲弊状態を考慮した省エネ開発

### 9.3. リソース制約
- 最小限のリソースで最大の成果を出す
- AI駆動ワークフローによる効率化

### 9.4. 開発方針（データベース）
- **テーブルは Sprint 0 で定義・作成する**
- 前回開発では途中からのマイグレーションが負荷となり、チーム全体でスキーマを揃えるのが難しかった経験がある
- そのため、必要なテーブル定義を Sprint 0 で確定し、Sprint 1 開始時点でテーブルが存在している状態にする
- Sprint 1 以降は原則として新規テーブル追加のみ（既存テーブルの変更は最小限に抑える）

---

## 10. 参考資料

- [12期アプリの現状分析](../reference/gen12_current_state.md)
- [プロジェクトコンテキスト](../reference/PROJECT_CONTEXT.md)
- [11期チームアプリ機能分析サマリー](../reference/11期チームアプリ機能分析_サマリー.md)
  - [くんよみ機能分析](../reference/11期チームアプリ機能分析_くんよみ.md)
  - [MOF機能分析](../reference/11期チームアプリ機能分析_MOF.md)
  - [wasabimonja機能分析](../reference/11期チームアプリ機能分析_wasabimonja.md)

---

**作成日**: 2026年1月28日  
**最終更新**: 2026年1月28日（11期チームアプリ機能分析を反映）  
**作成者**: しゅんすけ
